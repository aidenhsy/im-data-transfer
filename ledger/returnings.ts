import { DatabaseService } from '../database';

const run = async () => {
  const database = new DatabaseService();

  const details =
    await database.imProcurementProd.supplier_order_details.findMany({
      where: {
        id: {
          in: [
            '009db67e-19be-43bb-81ff-389b3803a466',
            '00ac4c57-f95a-42d3-b3a3-17ed0547129c',
            '00c66f71-08cc-404d-8f05-48a47b4a998e',
            '00cc8390-8948-4b94-8134-20ed4d2725a4',
            '010c2144-2d7c-4eb7-80b8-33ec7ea110fb',
            '01268a2c-0305-47e9-b7a0-7e27ebe6ba4c',
            '013e92b7-5a23-4445-9b2d-4435ab8d9649',
            '014e4320-521d-4018-b9f7-d0d98f3a3a3b',
            '01ed75f3-00b0-4217-abc7-6945b7aae59c',
            '01fc0f70-4df0-4bbb-b2aa-cba5a71f36b6',
            '0324f5c6-81cf-46a5-a500-36268cd3b2eb',
            '0340536d-2859-4fc3-b6ba-af386136a35d',
            '03acc2e6-4b06-4e73-9d42-c9861bf79029',
            '03bb73a8-4d5a-4f10-9d54-6172c5b73331',
            '0482e3b9-86c2-45b1-8d52-376b97832230',
            '05411989-0e60-46c5-977e-493d17257478',
            '05445a82-fd3a-4f01-ab80-342a9bc819cf',
            '0544f6ee-74c1-43d0-a12f-d4f3e4d676f2',
            '056101d6-b09e-467a-8ed4-6faa20ab0167',
            '057ae08b-c8e1-4b58-8b51-f2533bab3dec',
            '05e383c6-e9d7-4f8c-9310-af7e3d592031',
            '06a6e206-e886-4090-856e-62b2ce046c9b',
            '06e89b3b-191e-45db-a9d5-b8d25ef50ca0',
            '072f571d-7239-47b4-a57d-56f7d7d19598',
            '076f42a8-7531-4f10-bac7-cc6f3212e983',
            '07bcb144-b847-4d30-b489-e585c2375df8',
            '07c40b51-fbc2-4b32-800e-e9ceaca8b779',
            '07fab33a-88f2-453e-9e19-786378c4763e',
            '0871a498-cccb-4545-9418-b5b748c97728',
            '08a56c54-2a22-4575-a2c3-be2569272010',
            '092b12d8-daa9-41d8-8251-b3e195e36111',
            '095ea03f-f673-4f82-bb16-fdc303da8b9d',
            '0ab1e30c-e276-481a-9af3-42d43987a627',
            '0ab477eb-8ab3-4d12-9392-a2de8c6c4579',
            '0b244a9f-8aae-4972-9c3b-46870d922087',
            '0bb2331c-49c3-48f8-8bba-7d1c065dda07',
            '0c25f46d-dd03-42c7-a8de-b4f84d56c4d9',
            '0c2e3719-d4f2-40d8-b501-c327be8c07cb',
            '0c417885-9252-4f3e-84c2-c38591bb2561',
            '0ccdca8b-0f4a-4c90-ac90-88baa68d7379',
            '0ce9ffca-423f-440a-8c94-925e732b559c',
            '0d4ef5bd-702f-4f5c-be70-ff8713055fe8',
            '0d7d4641-4ec0-4890-bc63-5c13ee7093bb',
            '0e023b00-1d02-43ea-bc5f-a3f7aa9f7c05',
            '0e3c2cbd-b9f0-4c68-96ce-d1b19245f73d',
            '0eb57038-92e1-4f3b-bf5f-51e5768ad357',
            '0ec20c49-cf2d-45f4-b742-7bd99f6bd258',
            '0f1600cd-4856-466d-aecb-d37fc9b7c483',
            '0f37a27d-bdbb-4344-99ca-110f7faef6b1',
            '0f4b4ed6-21e7-4cff-abb9-df9976dc1227',
            '0f5e5c33-73af-4f72-89c9-4555a4ddfaf4',
            '105fbbd8-cd45-43cb-a368-84e85884457d',
            '10866df4-ad66-4384-83cb-9268d1356f6e',
            '109ee84a-f558-4786-86c1-bb67c51a0327',
            '10aa4cbb-b32e-4c48-969c-a6d4dcaac977',
            '10c07dca-d154-42c5-8f03-bd81e5097099',
            '10dcca47-28ba-4e7c-b464-9a7e8949e8a4',
            '10f43191-a596-40cb-b0f5-ca4302f53b43',
            '11a21846-2710-42bd-98ef-24a0263985bf',
            '1224dc77-38f6-495f-b77a-a359ed1e3568',
            '13373e9a-6240-4810-ac20-dab3179cc01b',
            '133a3ec7-ea6d-4b4b-a3a5-f6e59c15b53f',
            '13587507-8d4d-47ba-87be-6213d22d3052',
            '1365aa4e-676e-43b2-9624-055f9300389f',
            '139bc6c1-8bc3-4d7a-a816-d1f92ebf86f4',
            '13a54059-360a-4b59-a812-a3d1eadafb48',
            '13c062f0-d6f4-42b9-8015-cbbb85cd0bc3',
            '14200f2b-0110-46ad-8fb0-66cba99af442',
            '14f0c24b-265a-44aa-b6b1-552d232f4fea',
            '1517258b-32f0-47ce-b190-c6d202c31799',
            '15362e91-0725-4228-b43d-7a393ad9c254',
            '1576161d-8297-489c-a41f-06e36a02318c',
            '163fea39-bd7c-42ab-8dd6-7caf854133c7',
            '167dea30-55b9-4e5f-af6d-1b8223939c64',
            '16b99fa8-1d71-4f4b-942d-a6e656501cef',
            '16e1078a-2d59-49e4-a3f2-da66dd9a414c',
            '16f95e75-e5e9-4a2c-b831-4aac7f33ea40',
            '1722b373-735c-4097-88c7-6959f1913a18',
            '17d5ba46-f3a5-4881-aa0e-e04ec52f9b94',
            '1813087c-9d54-4dc3-97a6-9234067aa888',
            '18a32d79-1e5d-42d1-8801-329707834421',
            '18b0c282-29f6-451d-be72-e01433a6ae45',
            '18d4ed8b-76de-43fd-bebc-2c21cdf5d2cb',
            '18d5d7fc-aa75-4f2e-8a3b-aaa9b840cc64',
            '198b9ba7-27f1-469a-ae77-1a18b3c6784b',
            '19b69b3b-0f76-4b9f-a40e-46fce0b3b1ff',
            '19f6bf00-f007-46da-b48a-a8242c7ac77e',
            '1a07e957-0d89-4a60-9459-8a8e60677bc1',
            '1a7cebe0-e4f5-436e-9ae4-fa439186d8e4',
            '1abb1c27-a14f-4aa8-983f-f46f5b147f23',
            '1ad9c22e-bf0e-4340-b031-d9f8c22d6047',
            '1b70f3de-5520-4aee-8bd0-64ab0ae07827',
            '1b78de7d-f1ff-4db8-b7d2-5b80338c2505',
            '1cb701c5-bf7a-4642-b67b-c69d5e45f762',
            '1cccbbbf-372a-4f6c-98ac-afe55a7fdfcd',
            '1d13ad2d-78d8-4cdf-b2bd-2ba1d9f143a3',
            '1d15f4bf-7bec-4271-9650-d05a16cacb54',
            '1d57f697-a9d7-4144-9f8b-0c513fcddf94',
            '1d913810-ca22-472d-a747-b78cd6c37854',
            '1dfe75e0-e32b-4c4d-b0ac-0097f87a7c56',
            '1e109129-734b-469c-8e42-665b58251161',
            '1e5816ec-f4f3-40f0-84da-56cff6c6b7e4',
            '1eb5961d-0d0b-4c26-b5eb-9861942b80b2',
            '1ec3801f-6b69-4940-8f98-fe6405e9c19c',
            '1f127de3-46b3-446b-bc02-c4c4af8fdd87',
            '1f270ff4-245d-4b71-897c-16e2817e9414',
            '1f66531f-aca3-4c08-a4b3-d60d8fea0edb',
            '2013a242-9d84-47c6-a5d2-d17d40849b72',
            '2042786c-23e5-4db6-85ae-dc4a4f464d4b',
            '205a0393-5ee6-4a1f-be09-200a4c70b0fa',
            '206b25bf-30fe-4074-a352-07b092347458',
            '20b477fd-8966-4792-b030-12c70cadfff7',
            '20bf121b-cdc8-45e3-bc6e-e6d944d78f14',
            '218afcc8-531b-457b-bfd4-02785c840c0d',
            '21f2dcc7-8147-42f4-9e7b-1595b266db54',
            '229fbe45-ea1c-45e2-81da-9dd298c2ed3a',
            '22b551fd-b949-42ee-b3a5-e4a626c3e09d',
            '2312a370-34d3-400c-b2cb-fa4e1f9a4ea0',
            '23e45f9a-9736-4059-b2e0-961cd844c523',
            '240611cb-8bb3-47da-bc26-69592cf8b2e6',
            '244fb6a5-ab74-48fc-b663-1c71ded11fa6',
            '2493ccf4-3f41-4fc5-8cb4-8aeec603c158',
            '24d70350-ae07-4637-854c-11a8e3fc87c6',
            '24f819dd-da1c-44a9-8be7-97641423ebcb',
            '24fb9569-b5e6-4686-b140-e9cb556845c7',
            '252e32d8-d602-4a9d-bafe-184542bdd4dc',
            '25390b00-2224-46ff-aaf3-d39c89322602',
            '25ad2fbd-e2a3-4f83-a659-ea4f72352a45',
            '25e36f73-c557-4e6c-8e50-08716872eba8',
            '2638abb3-d5ad-4dfc-9984-9bf16e7dab74',
            '26518cbe-fb89-4c7c-bc0d-ebcfacbf959b',
            '269a4b56-0698-4bf9-b8ba-a4db360e12e2',
            '26c90a0b-b960-40bd-b27c-76bad27d949f',
            '2725b6d3-dfce-4f05-99fc-4f6b0a6326e5',
            '27a6d186-c697-4a05-95de-ce016b5b254b',
            '27c4713c-9654-412e-ac0d-f4d65aa46228',
            '27f7d25e-e524-49e2-a94d-dcf828ae7555',
            '28392f2e-d01d-4962-85ce-eb90c0004088',
            '28e72b28-02ff-4a7a-a4fe-0933ff5e8aca',
            '298d82cb-ad8a-49ea-8e4e-bb6e07be41da',
            '2993a914-7ce9-464c-bf5b-dc804b4b15a7',
            '29eff167-4345-4f87-9e9c-65e12eeeb155',
            '2a4cb871-4e75-49c5-b2c4-f4bd4fface97',
            '2a754ec2-b554-4fe0-83f2-f3e657eca1b6',
            '2ac37230-5491-4162-b169-b2be90f674c2',
            '2b3e794a-53be-4b4c-b47a-924339cf9fcb',
            '2b648741-d679-4ed5-b274-77cace72f598',
            '2b85a52a-7c0e-4ef1-af91-68efb681e66c',
            '2c2442d9-1dfb-4188-9126-9bb86f5ef37d',
            '2c42dfa5-3442-450e-9c2c-003738d33694',
            '2c60e96f-038c-44fa-80d7-3eaf616cc285',
            '2c616c95-888c-4e8e-88dd-e80694832222',
            '2c6e1dc2-f440-40ac-bfbf-a6bc9dccaf03',
            '2cc2aeee-baf5-4681-86f6-dde7ff646290',
            '2d3cd2f1-b80b-4ce0-8403-120696bbf8f5',
            '2d3d6fec-90fd-4a76-a399-80169b3a7e33',
            '2dc1327b-d481-445c-843c-94b23b329a26',
            '2f11a5c6-398c-4684-b546-944e5dc4117a',
            '2f8bd8c1-85ad-413a-b13c-24df3911a3df',
            '2fa245d4-f1aa-42f1-9c61-d3c52f7be3ce',
            '2fde8384-863c-41c9-b067-585f44c5acf4',
            '2fe4221f-858f-4d4e-b9f4-023efb97f35a',
            '30753e62-dd60-4057-a519-c4473a261c61',
            '30b7c6d0-3e96-4c5f-80e9-8501e75f708c',
            '313a80cb-81a5-484d-a874-cd03775cb6db',
            '31b3d66c-19f7-4330-aed3-d35055307469',
            '32d015eb-fe8b-4a4c-912f-a667d4f59819',
            '32d31df7-a630-418c-be9f-ed0735e7be57',
            '33b8a34f-d6bc-415d-8379-6aef644258ee',
            '33d79bca-8dcf-4ac1-9480-04717a2228f1',
            '33faa869-f775-4c1f-a907-e02387aba3cd',
            '34090495-8eff-412e-b075-850ea05abfa6',
            '341c78c8-7139-450c-a4e5-c7644135924c',
            '343395da-be8b-4d85-a8d7-5bc9116eeb6e',
            '345e39d5-63a8-40d9-8f89-6af0207b5bb2',
            '346279f1-62eb-48b8-9baf-a96c15a616ff',
            '349d6e42-16e3-41b0-bc7b-fb5646added4',
            '349ec4b4-d434-4921-905b-e15b921977a5',
            '34e06c6b-e9d8-4a06-9d5f-d6ee8ed1f1ee',
            '35705e2d-1f08-4a94-9b9c-fabd75554c14',
            '35720a89-1a02-498e-ad20-1826cdb88e17',
            '3581c2b3-ed46-49f1-8035-857a7a9a7f8e',
            '35af9764-53cd-4783-9fb3-7f9953b55895',
            '35e34729-10ff-4dbf-82bb-57f57ae0bbc2',
            '36d21c32-ee55-49c5-b068-7a5eee61f012',
            '36d41b98-389c-407b-842b-25f2f7c26070',
            '37409d77-454a-40db-b8ae-e4cabf858092',
            '37e9c8fe-0d5e-4427-95d0-f8878b9ba3d5',
            '38057cf8-f8f6-4e22-9bcf-8cc172d34676',
            '380b540f-557e-4f63-9696-06326b72bf21',
            '3855a812-736f-4ce6-9db7-95bd6474a7e5',
            '39265074-f4ab-4cf4-8a63-1cdb8a95c1d8',
            '3972c9e5-a2c7-4758-bac4-f4323e6f4e86',
            '398b2025-a244-41db-84d6-10c0cd4e1acb',
            '39ee5116-f512-4c88-a362-f913facd0a65',
            '39f8d687-6ae7-431d-8b01-3f98a6d288bb',
            '3a94ed3a-8643-409f-bad0-3f53e75e40f6',
            '3b0c13b7-c02d-4ddd-a731-e1fa6ead1f8e',
            '3b241b6d-d6d4-4729-a05f-043a32c349de',
            '3c180841-7e24-4804-8ea5-b5c224e66cf9',
            '3d16b5bd-6201-489e-973e-0e11fb0d3151',
            '3d860853-0357-4caa-82d2-47fc2b1edbc7',
            '3dcc45e3-f485-42fb-b56f-e6c08a79acce',
            '3eaf77bb-ad74-4d8a-985a-e81f2a54d768',
            '3eded408-ae22-413e-abdb-eb283050ed2b',
            '3f163668-e56f-4965-896e-1a67f42e8e26',
            '3f512262-2891-4448-96d7-cfa3c11cb429',
            '3fa2f499-ae01-4818-b6aa-c2cb8283aabd',
            '402da2a3-58cb-497d-b477-036313a9036b',
            '40320f04-386d-4e43-9996-c23b6370a6a1',
            '40acdbb8-f1c1-48b8-89f4-2afe5bfc1213',
            '40b38f54-c407-4af1-a9f5-3eee225baeae',
            '40f5179c-c90c-4e50-8a93-162ec7e14813',
            '411a6a9c-9a97-4aeb-a7d8-9a703fffdc11',
            '411e0ebe-eef0-4567-96d2-c2518cc84fc4',
            '416b62bb-7df3-496c-bd88-099f6a101ca5',
            '419ac12e-dc2b-4143-a3c5-12539f215985',
            '4211ae4c-f8ba-4f71-8005-be6f048a2be2',
            '424d767e-eb69-4c16-8753-b1795530e64e',
            '42ba830e-425f-46c5-b77a-9cd431533d30',
            '42cac816-0efb-4bc2-b0d5-d78929353a62',
            '42cf1802-a3cf-48d8-bf8b-d5b40419c7c2',
            '43890e63-2fa3-4001-8c2b-276d294915d4',
            '43b5e5c0-4843-494d-a660-2938d4769a30',
            '43bb069c-2407-4dcb-800a-66aea39fd89b',
            '440a1006-22fa-4e8d-b7a5-16f3f301a83d',
            '44327765-b2b1-4d4e-afe1-cc29b739cbf3',
            '4454871d-cf49-485c-b47c-5f8f53e1feda',
            '453aa087-cb31-4bc1-8f1b-09bfc77dfe82',
            '45604de1-f917-4d09-af5c-31f8de99c805',
            '45c27087-b3dc-4860-8cd5-2e0f20f11295',
            '460f20d3-8f25-4d67-9dbf-2f8c157068e0',
            '464bedf7-32f2-4740-be43-03d95191dd22',
            '469e796c-282e-4625-88c0-10e2fc75fc21',
            '47da7a07-c133-424a-a754-1680cf2bbff2',
            '4877d4e5-ce7f-4ca7-8b40-b4cde5867b68',
            '488c6a51-e8f5-493e-9ee9-169c70f13bc7',
            '48eb96de-9572-427b-beac-2d8267688658',
            '49082eb6-05d5-480a-b4c1-2fc566356542',
            '493748d0-13dc-420a-8031-e9395b4b76bc',
            '49bc2f52-6da4-45f7-8721-35f3009b14ff',
            '49f5dc17-ff1c-48a7-a1b0-8fefd0eb815f',
            '4a2176b0-7825-4d0e-a131-44fd57f439be',
            '4a5593bc-215d-4a8e-b323-6a93c6e34d8d',
            '4ab08f9d-19d9-4474-ac9a-04dd01b0cad3',
            '4ad9c01f-9f13-42fe-b4f5-4a3155068f58',
            '4ae41c5b-b250-4eb1-9f0d-7d288b37ab1c',
            '4b284e51-82e7-4c1e-90f0-908047905a35',
            '4b64d4c4-6ef3-4be4-acfa-7d35d5985196',
            '4b8b07cc-b2fe-4163-91f4-9ff097832f2b',
            '4caa54bc-10b0-4728-bd1a-33c135c1b9b5',
            '4cb6c121-fe9e-4b90-929e-aef5b083ae6f',
            '4ce54502-7ea3-4bb9-93d9-7c7cd87fee19',
            '4d0f3b02-1693-4375-97fb-d6842bf4fd93',
            '4d3f5948-74f1-4db3-b854-cf03108a6209',
            '4ef499ac-7f7d-44f8-a7de-720d7a69c8be',
            '4f1ad9d3-96e0-4ef6-a0cb-65cfde78da00',
            '4f4910c9-e384-411f-ab5a-f788b39a38c5',
            '50b86874-c9e6-4ba5-a7f6-e8f470816fc3',
            '50d7cf86-f95f-49e0-b2e9-42e7e0112d6a',
            '511d2ba5-ac89-4c4b-9690-d256bc1ec578',
            '5167d668-b586-4977-b19b-e2f6b49768a2',
            '517de824-40f6-439e-8b64-0d147c7ff8ea',
            '5185860d-eaf8-41f6-91df-8d8ba90392ea',
            '51ed9598-9e78-4868-b574-ed43bdd3d518',
            '524b861d-e095-47af-b4cb-0908a098e9d9',
            '542c165a-1163-44c3-99ed-d69662e8edd4',
            '5475e2db-5a29-4359-a777-e74b0c376226',
            '54be0023-0157-46d5-9c82-3bccdff9c402',
            '54c828bb-a9e0-4f62-977a-4259bacebd07',
            '55b41997-8a97-47ff-aa71-a353c5348376',
            '56a5a162-9734-4f1b-8e25-a7f839028063',
            '56d7f38d-95ad-404f-98f0-8443ba884d77',
            '57185cfb-b3aa-4144-b7ff-31246517e88f',
            '575cb5d9-5406-43ae-99d7-01543b4b4c5c',
            '578f764b-7b1d-4ce7-8e4a-651ffbcbcde0',
            '57e012a1-49c2-4174-aefe-92333c97cba5',
            '5879d6dd-6f23-4eee-87e9-8040b19421ba',
            '58ecee54-4689-4982-947f-39614759851a',
            '58ff3e2b-b008-47f3-903f-1704276b5375',
            '59396af7-968c-4a21-a162-66fd3c1ddfc8',
            '59af2038-3c97-40a5-a4c9-38b68f7aec70',
            '59f09da2-a6c5-44dd-8e26-de6e07f440df',
            '5a4e3066-6ff4-4fa7-84c0-730c06853013',
            '5a7dbc69-eacf-4e68-a0d1-87b3e6186157',
            '5b0fce50-3ac3-4225-bb85-e159e7b21053',
            '5b1fbbbf-90d0-4b41-82a7-ac52c85cd2d0',
            '5b8a96e1-f098-4f4d-88c0-8907e0cf5166',
            '5c2c4cbf-addb-4689-88ad-0a9916fabac0',
            '5c8e5b51-2e47-493f-872a-ab046c240560',
            '5ca7938b-f3fe-4561-9b77-7ef012fcacc6',
            '5d260671-4166-428b-94cc-95fb13326f2a',
            '5d466298-6365-4736-a07d-8afde9f9aa8d',
            '5dad74c2-80ca-4489-920d-efa1a33ad67b',
            '5de7ba57-5664-4532-87f3-f31f03a13f8b',
            '5e1007ea-1112-49fd-b70b-4fb1c6a1b5ab',
            '5e11ae57-f629-4904-a828-4a081d016f0a',
            '5f5bc592-8d2a-460e-8c7e-42141b037854',
            '6152d9e1-2a05-4877-be90-1aaaca1ccad8',
            '619de93f-f71f-4431-92d6-9b242c1c941c',
            '626a411e-b01b-4ec4-a8aa-06fe6e0b67f0',
            '6308f381-4cfc-4cd9-8043-539401c6ef1c',
            '630b5b0c-950a-4455-b0fc-1c7bfec153e7',
            '63a1b9ab-317f-4b83-ad09-dd37a2e81a5f',
            '63a9d112-2895-4e77-96c6-ab299efaa513',
            '63ea7273-38e9-456b-80cc-43b9f5064c52',
            '63ee89ed-fdb5-42af-9d2b-7b60bf95f011',
            '64069f64-7f2c-46ab-8c89-ef86b64f94b5',
            '6465861b-dbab-44f6-9b25-169d930f9022',
            '646f5fab-e2cb-4e05-be5a-af062c3ec3da',
            '64bdc350-ebc7-4e1d-9657-e33f866e182f',
            '64f87fda-d967-448a-b40a-4ef1392c1037',
            '66f98c84-e4fe-4936-8c49-129e50b94481',
            '6724153d-aafb-449c-bee6-2e98200ee7c7',
            '6732aab9-50c7-4b75-8fbd-86fef91c7ae8',
            '678bca8d-378b-45e2-927e-71d629149ee7',
            '67c7aa28-3938-4921-827e-93954c2627e9',
            '6808338a-d219-435a-9bb3-3df7470a77a6',
            '68bc9b48-f923-49f2-a9d1-499ffe9844fb',
            '693b4d60-22fb-4f8b-a0c1-b3592912df62',
            '69b72d9b-4a46-4a31-ae43-79ba169f4b7d',
            '69d805a1-21f2-4b16-ba89-40d9bb7ea6a9',
            '6a445a06-3437-4c74-a505-2e5696b817af',
            '6a8d68ef-d968-4e13-869f-d44f2d106f8f',
            '6a9e5eba-3568-4c93-9922-12a32bdf773a',
            '6ad4673b-0fc1-4954-8699-703d9a3b08fb',
            '6baca17b-bf69-4fce-960d-47e2a72d1335',
            '6bf62438-1ac8-4685-9fc0-8f3529dead78',
            '6c03bd8f-8c26-4128-ab28-c6d34625b537',
            '6c15d330-3374-49fc-aab5-bd142f701990',
            '6c996806-bb45-4227-a024-b1f16d1abc46',
            '6c9abaa6-a422-4782-bfce-f3072c76b10f',
            '6ce2052a-1871-4437-859c-18300a92efe5',
            '6ceb542f-8aaf-458c-a784-1db7775b4485',
            '6d0ea9c5-df49-4769-813e-1df087fc98ac',
            '6dc19ead-8fe6-4519-adb2-19bf4d03c967',
          ],
        },
      },
      include: {
        supplier_orders: true,
      },
    });

  for (const detail of details) {
    const returnQty =
      Number(detail.actual_delivery_qty) - Number(detail.final_qty);
    console.log(
      `actual_delivery_qty: ${detail.actual_delivery_qty}, final_qty: ${detail.final_qty}, returnQty: ${returnQty}`
    );

    if (returnQty > 0) {
      console.log('returnQty > 0');
      const existReturn =
        await database.imProcurementProd.supplier_order_return_details.findFirst(
          {
            where: {
              source_detail_id: detail.id,
            },
          }
        );
      if (existReturn) {
        console.log('found');
        const scmReturn =
          await database.scmOrderProd.procurement_order_return_details.findFirst(
            {
              where: {
                procurement_order_details: {
                  reference_id: detail.supplier_reference_id,
                },
                procurement_order_returns: {
                  client_return_id: existReturn.return_id,
                },
              },
            }
          );
        if (scmReturn) {
          await database.imProcurementProd.supplier_order_return_details.update(
            {
              where: {
                id: existReturn.id,
              },
              data: {
                qty_returned: returnQty,
              },
            }
          );
          await database.scmOrderProd.procurement_order_return_details.update({
            where: {
              id: scmReturn.id,
            },
            data: {
              qty_returned: returnQty,
            },
          });
        }
      } else {
        const newReturn =
          await database.imProcurementProd.supplier_order_returns.create({
            data: {
              supplier_id: 1,
              shop_id: detail.supplier_orders.shop_id,
              original_order_id: detail.order_id,
              status: 1,
              note: '补退货',
              return_reason_id: 1,
            },
          });
        await database.imProcurementProd.supplier_order_return_details.create({
          data: {
            return_id: newReturn.id,
            supplier_item_id: detail.supplier_item_id!,
            source_detail_id: detail.id,
            qty_returned: returnQty,
            unit_price: detail.price,
          },
        });
        const scmOrder =
          await database.scmOrderProd.procurement_orders.findFirst({
            where: {
              client_order_id: detail.order_id,
            },
            include: {
              procurement_order_details: true,
            },
          });
        const newScmReturn =
          await database.scmOrderProd.procurement_order_returns.create({
            data: {
              client_id: 1,
              shop_id: detail.supplier_orders.shop_id,
              original_order_id: scmOrder?.id!,
              status: 1,
              note: '补退货',
              client_return_id: newReturn.id,
              return_reason_id: 1,
            },
          });
        const scmOrderDetail = scmOrder?.procurement_order_details.find(
          (item) => item.reference_id === detail.supplier_reference_id
        );
        await database.scmOrderProd.procurement_order_return_details.create({
          data: {
            return_id: newScmReturn.id,
            good_id: scmOrderDetail?.good_id!,
            good_name: scmOrderDetail?.name!,
            source_detail_id: scmOrderDetail?.id!,
            qty_returned: returnQty,
            unit_price: detail.price,
          },
        });
      }
    }
  }
};

run();
